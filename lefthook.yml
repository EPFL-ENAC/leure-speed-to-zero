# RC file to ensure proper PATH for npm/npx
rc: ./.lefthookrc

commit-msg:
  commands:
    commitlint:
      run: npx --no -- commitlint --edit {1}

# EXAMPLE USAGE:
#
#   Refer for explanation to following link:
#   https://github.com/evilmartians/lefthook/blob/master/docs/configuration.md
#
# pre-push:
#   commands:
#     eslint-audit:
#       tags: frontend eslint
#       run: npm run lint
#     typescript-audit:
#       tags: frontend typescript
#       run: npm run type-check

pre-commit:
  parallel: true
  commands:
    # Format frontend files (JS, TS, Vue, JSON, etc.)
    prettier-format:
      glob: "*.{js,ts,jsx,tsx,vue,json,css,scss,md,yml,yaml}"
      run: npx prettier --write {staged_files} && git add {staged_files}
      tags: frontend format
    # Format backend Python files
    black-format:
      glob: "backend/**/*.py"
      run: cd backend && (uv run black {staged_files} || .venv/bin/black {staged_files}) && git add {staged_files}
      tags: backend format
    # Lint backend Python files
    flake8-lint:
      glob: "backend/**/*.py"
      run: cd backend && (uv run flake8 {staged_files} --count --select=E9,F63,F7,F82 --show-source --statistics || .venv/bin/flake8 {staged_files} --count --select=E9,F63,F7,F82 --show-source --statistics)
      tags: backend lint
